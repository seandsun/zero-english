---
import Icon from '@/components/icons/icon.astro';

interface Props {
  title: string;
  relatedLinks: { href: string; text: string }[];
  currentPath: string;
}

const { title, relatedLinks, currentPath = '' } = Astro.props as Props;

// Función para normalizar y comparar rutas (evita errores de barras diagonales)
const isActive = (href: string) => {
  if (!currentPath || !href) return false;

  // Normalizamos ambas rutas: quitamos barras finales y aseguramos que sean strings
  const normalize = (path: string) =>
    String(path).toLocaleLowerCase().replace(/\/$/, '');

  return normalize(currentPath) === normalize(href);
};
---

<aside
  class="w-full px-2 py-2.5 flex flex-col gap-1.5 mb-10 rounded-md border border-custom-blue-700 dark:border-custom-blue-500 font-medium text-sm"
>
  <span
    class="flex items-center gap-2 text-base text-custom-blue-700 dark:text-custom-blue-500 leading-5"
  >
    <div>
      <Icon name="handClick" />
    </div>
    {title}
  </span>
  <div class="flex flex-col gap-1.5 xl:max-h-full xl:overflow-y-auto">
    {
      relatedLinks.map(({ href, text }) => (
        <a
          href={href}
          class:list={[
            'rounded-[2px] p-1',
            isActive(href)
              ? 'bg-custom-blue-800 text-white'
              : 'bg-gradient-to-b from-custom-blue-200 to-custom-blue-500 text-gray-dark',
          ]}
        >
          {isActive(href) && '• '} {text}
        </a>
      ))
    }
  </div>
</aside>
